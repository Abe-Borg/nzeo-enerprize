{% extends "base_nav_top_sidebar.html" %}
{% load static %}

{% block center-panel-content %} 
<div id="district-map" style="height: 700px;"></div>

<script src="{% static 'maps/annotations.js' %}"></script>
<link href="{% static 'maps/annotations.css' %}" rel="stylesheet">

<script>
    var map;
    // Define the southwest and northeast corners of your district
    var corner1 = L.latLng('{{southwest_lat}}', '{{southwest_lng}}');
    var corner2 = L.latLng('{{northeast_lat}}', '{{northeast_lng}}');
    var bounds = L.latLngBounds(corner1, corner2);

    // Initialize the map with dynamic coordiantes and zoom level
    var latitude = parseFloat("{{ district_geo_lat }}");
    var longitude = parseFloat("{{ district_geo_long }}");
    var zoomLevel = parseInt("{{ map_zoom_level }}");

    function initMap() {
        map = new google.maps.Map(document.getElementById('district-map'), {
            center: { lat: latitude, lng: longitude },
            zoom: zoomLevel
        });

        // Rest of the annotation logic goes here
    }
    
    // Annotation Placement Logic
    var annotationMode = false;
    var currentAnnotation;

    // Function to start annotation placement
    function startAnnotation() {
        annotationMode = true;
    }

     // Click event on the map for placing annotations
    map.addListener('click', function(e) {
        if (annotationMode) {
                currentAnnotation = new google.maps.Marker({
                    position: e.latLng,
                    map: map
                });
        }
    });

    // Keyboard event listener for confirming or canceling annotations
    document.addEventListener('keydown', function(event) {
        if (annotationMode) {
            if (event.key === "Enter") {
                // Confirm and save the annotation
                annotationMode = false;
            } else if (event.key === "Escape") {
                // Cancel the annotation
                currentAnnotation.setMap(null);
                annotationMode = false;
            }
        }
    });

    // Example: Attach startAnnotation to an icon or button click
    document.getElementById('your-icon-id').addEventListener('click', startAnnotation);
</script>


{% endblock %}
